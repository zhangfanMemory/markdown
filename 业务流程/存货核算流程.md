## 存货核算
### 计算流程
#### 从接入mq开始
    1. 以实时计算流程开始
       1. 首先发送方会按照公司商品仓库进行hash后进行对队列数进行取余，此目的是为了将同一个商品分配到同一个队列中对后续的计算友善 -- 业务
       2. 在队列数远超于节点数的情况下，每个节点，每次默认拉取20条数据可能来自于不同的队列，不同的商        --业务
       3. 代码处理流程是每个mq消费节点都起了5个线程拉取数据，每次批量拉取10条，单次流程最多处理50条数据     --tps
       4. 由于计算要顺序处理，线程池处理不同商品可能造成同一个商品的并发问题，创建本地队列对
          1. 本地队列的作用
             1. 将次批次数据根据商品hash分别投放到不同的队列
             2. 保证同一时刻某一个商品只能有一个线程在执行，此处只能保证到此，因为计算需要严格的先后顺序而严格的先后顺序需要根据从数据库查询出来的数据为准
             3. 首先生成执行器，将队列放入执行器，执行器用于放在线程池执行
             4. 数据存入队列：push的时候不能进行快照的消费，禁止写入；获取快照的瞬间不能进行写入，也禁止写入
             5. 本地队列进行push和await，push将数据推送到queue中，await使用线程池对所有执行器中对应自身的的queue进行执行
       5. 后续统一抽象流程 -- 区分是只计算数量或者是计算成本或者是需要计算成本
       6. 因为存在不同的周期，根据时间段区分，每个时间段落采用的模板可能不同
       7. 后续采用模版方式根据，根据模板的不同使用不同的计算流程
       8. 使用模板方式

